# Система фильтров для генерации статей

## Обзор

Система фильтров позволяет пользователям точно настраивать параметры генерируемых статей через интуитивный интерфейс. Фильтры открываются в модальном окне и работают совместно с текстовым промптом для максимальной персонализации контента.

## Компоненты

### 1. RefinementBar (Плавающая панель ввода)
- **Расположение**: Фиксированная позиция внизу экрана
- **Элементы**:
  - Кнопка фильтров (слева)
  - Поле ввода промпта "how to..."
  - Кнопка отправки (справа)
- **Индикация**: Кнопка фильтров подсвечивается при наличии активных фильтров

### 2. FilterModal (Модальное окно фильтров)
- **Заголовок**: "Detailed filters"
- **Тело**: Прокручиваемый список фильтров
- **Футер**: Кнопки "Clean" и "Regenerate"

## Типы фильтров

### Segmented Control (Одиночный выбор)
Используется для параметров с взаимоисключающими опциями:

#### Style (Стиль)
- Casual - неформальный, дружелюбный тон
- Professional - деловой, официальный стиль
- Technical - технический, детальный подход

#### Length (Длина)
- Brief - краткое изложение
- Detailed - подробное описание
- Comprehensive - исчерпывающий материал

### Chip Buttons (Множественный выбор)
Используется для параметров, которые можно комбинировать:

#### Target Audience (Целевая аудитория)
- Beginners - новички
- Intermediate - средний уровень
- Experts - эксперты
- General Public - широкая аудитория

#### Format (Формат)
- Step-by-Step - пошаговая инструкция
- Checklist - чек-лист
- Overview - обзор
- Comparison - сравнение

#### Additional Sections (Дополнительные разделы)
- Tips & Tricks - советы и хитрости
- Common Mistakes - частые ошибки
- FAQ - часто задаваемые вопросы
- Resources - полезные ресурсы

## Логика работы

### Открытие модального окна
```javascript
// Клик по кнопке фильтров в RefinementBar
onFilterClick={() => setShowFilterModal(true)}
```

### Выбор фильтров
```javascript
// Segmented Control - одиночный выбор
handleFilterChange('style', 'professional')

// Chip Buttons - множественный выбор (toggle)
handleFilterChange('audience', 'beginners', true)
```

### Формирование промпта
При нажатии "Regenerate" система:
1. Собирает все выбранные фильтры
2. Формирует детальный промпт:
   ```
   Style: professional. Length: detailed. 
   Target audience: beginners, intermediate. 
   Format: step-by-step. Include: tips, faq.
   ```
3. Комбинирует с основным промптом пользователя
4. Отправляет на генерацию

### Очистка фильтров
```javascript
// Кнопка "Clean" сбрасывает все выбранные фильтры
handleCleanFilters()
```

## Интеграция с AI

Фильтры передаются в `handleGenerate` как параметр `detailedPrompt`:

```javascript
handleGenerate(
  fullPrompt,      // "How to bake a cake"
  detailedPrompt,  // "Style: casual. Length: detailed..."
  currentArticleId
)
```

AI модель использует эти параметры для:
- Выбора тональности и стиля изложения
- Определения уровня детализации
- Адаптации контента под целевую аудиторию
- Структурирования материала в нужном формате
- Добавления запрошенных дополнительных разделов

## Преимущества

1. **Быстрая настройка**: Не нужно писать длинные текстовые инструкции
2. **Визуальная обратная связь**: Видно, какие параметры выбраны
3. **Гибкость**: Можно комбинировать фильтры и текстовый промпт
4. **Контекстуальность**: Фильтры адаптируются под тему статьи
5. **Повторяемость**: Легко воспроизвести нужную конфигурацию

## Стилизация

### CSS классы

**Модальное окно**:
- `.filter-modal-overlay` - затемненный фон
- `.filter-modal-content` - контейнер модального окна
- `.filter-header` - заголовок с кнопкой закрытия
- `.filter-body` - прокручиваемое тело
- `.filter-footer` - футер с кнопками

**Segmented Control**:
- `.segmented-control` - контейнер
- `.segment-btn` - кнопка сегмента
- `.segment-btn.active` - активная кнопка

**Chip Buttons**:
- `.chip-group` - контейнер
- `.filter-chip` - чип
- `.filter-chip.active` - активный чип

**Кнопки**:
- `.btn-clean` - кнопка очистки
- `.btn-regenerate` - кнопка регенерации

## Расширение системы

Для добавления новых фильтров:

1. Добавьте фильтр в `generateFilters()`:
```javascript
{
  id: 'tone',
  label: 'Tone',
  type: 'segmented', // или 'chips'
  options: [
    { value: 'formal', label: 'Formal' },
    { value: 'friendly', label: 'Friendly' }
  ]
}
```

2. Обработайте в `handleRegenerateWithFilters()`:
```javascript
if (selectedFilters.tone) {
  detailedPrompt += `Tone: ${selectedFilters.tone}. `;
}
```

## Будущие улучшения

- Динамическая генерация фильтров через AI на основе темы статьи
- Сохранение наборов фильтров (пресеты)
- История использованных комбинаций
- Умные рекомендации фильтров
- Предпросмотр влияния фильтров
