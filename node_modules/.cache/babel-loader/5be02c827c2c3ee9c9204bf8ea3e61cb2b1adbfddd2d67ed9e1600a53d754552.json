{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);// Check if user is authenticated on initial load\nuseEffect(()=>{const checkAuthStatus=async()=>{try{const response=await fetch('http://localhost:3003/api/auth/me',{credentials:'include'// Include cookies in the request\n});if(response.ok){const data=await response.json();setUser(data.user);}}catch(error){console.error('Failed to check auth status:',error);}finally{setLoading(false);}};checkAuthStatus();},[]);const login=async(email,password)=>{const response=await fetch('http://localhost:3003/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',// Include cookies in the request\nbody:JSON.stringify({email,password})});if(!response.ok){let errorMessage='Login failed';try{const errorData=await response.json();errorMessage=errorData.error||errorData.message||JSON.stringify(errorData);if(typeof errorMessage==='object'){errorMessage=JSON.stringify(errorMessage);}}catch(e){errorMessage=\"Server error: \".concat(response.status,\" \").concat(response.statusText);}throw new Error(errorMessage);}const data=await response.json();setUser(data.user);return data;};const register=async(email,password)=>{const response=await fetch('http://localhost:3003/api/auth/register',{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',// Include cookies in the request\nbody:JSON.stringify({email,password})});if(!response.ok){let errorMessage='Registration failed';try{const errorData=await response.json();errorMessage=errorData.error||errorData.message||JSON.stringify(errorData);if(typeof errorMessage==='object'){errorMessage=JSON.stringify(errorMessage);}}catch(e){errorMessage=\"Server error: \".concat(response.status,\" \").concat(response.statusText);}throw new Error(errorMessage);}const data=await response.json();setUser(data.user);return data;};const logout=async()=>{try{await fetch('http://localhost:3003/api/auth/logout',{method:'POST',credentials:'include'});}catch(error){console.error('Logout error:',error);}finally{setUser(null);}};const loginWithGoogle=()=>{// Redirect to Google OAuth endpoint\nwindow.location.href='http://localhost:3003/api/auth/google';};const refreshUser=async()=>{try{const response=await fetch('http://localhost:3003/api/auth/me',{credentials:'include'});if(response.ok){const data=await response.json();setUser(data.user);}}catch(error){console.error('Failed to refresh user:',error);}};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,login,register,logout,loginWithGoogle,refreshUser,loading},children:children});};export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","checkAuthStatus","response","fetch","credentials","ok","data","json","error","console","login","email","password","method","headers","body","JSON","stringify","errorMessage","errorData","message","e","concat","status","statusText","Error","register","logout","loginWithGoogle","window","location","href","refreshUser","Provider","value","useAuth"],"sources":["D:/SRC/XAMPP/htdocs/sites/Briefer-v02/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Check if user is authenticated on initial load\r\n    useEffect(() => {\r\n        const checkAuthStatus = async () => {\r\n            try {\r\n                const response = await fetch('http://localhost:3003/api/auth/me', {\r\n                    credentials: 'include' // Include cookies in the request\r\n                });\r\n                \r\n                if (response.ok) {\r\n                    const data = await response.json();\r\n                    setUser(data.user);\r\n                }\r\n            } catch (error) {\r\n                console.error('Failed to check auth status:', error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        checkAuthStatus();\r\n    }, []);\r\n\r\n    const login = async (email, password) => {\r\n        const response = await fetch('http://localhost:3003/api/auth/login', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            credentials: 'include', // Include cookies in the request\r\n            body: JSON.stringify({ email, password })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            let errorMessage = 'Login failed';\r\n            try {\r\n                const errorData = await response.json();\r\n                errorMessage = errorData.error || errorData.message || JSON.stringify(errorData);\r\n                if (typeof errorMessage === 'object') {\r\n                    errorMessage = JSON.stringify(errorMessage);\r\n                }\r\n            } catch (e) {\r\n                errorMessage = `Server error: ${response.status} ${response.statusText}`;\r\n            }\r\n            throw new Error(errorMessage);\r\n        }\r\n\r\n        const data = await response.json();\r\n        setUser(data.user);\r\n        return data;\r\n    };\r\n\r\n    const register = async (email, password) => {\r\n        const response = await fetch('http://localhost:3003/api/auth/register', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            credentials: 'include', // Include cookies in the request\r\n            body: JSON.stringify({ email, password })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            let errorMessage = 'Registration failed';\r\n            try {\r\n                const errorData = await response.json();\r\n                errorMessage = errorData.error || errorData.message || JSON.stringify(errorData);\r\n                if (typeof errorMessage === 'object') {\r\n                    errorMessage = JSON.stringify(errorMessage);\r\n                }\r\n            } catch (e) {\r\n                errorMessage = `Server error: ${response.status} ${response.statusText}`;\r\n            }\r\n            throw new Error(errorMessage);\r\n        }\r\n\r\n        const data = await response.json();\r\n        setUser(data.user);\r\n        return data;\r\n    };\r\n\r\n    const logout = async () => {\r\n        try {\r\n            await fetch('http://localhost:3003/api/auth/logout', {\r\n                method: 'POST',\r\n                credentials: 'include'\r\n            });\r\n        } catch (error) {\r\n            console.error('Logout error:', error);\r\n        } finally {\r\n            setUser(null);\r\n        }\r\n    };\r\n\r\n    const loginWithGoogle = () => {\r\n        // Redirect to Google OAuth endpoint\r\n        window.location.href = 'http://localhost:3003/api/auth/google';\r\n    };\r\n\r\n    const refreshUser = async () => {\r\n        try {\r\n            const response = await fetch('http://localhost:3003/api/auth/me', {\r\n                credentials: 'include'\r\n            });\r\n            \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setUser(data.user);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to refresh user:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, login, register, logout, loginWithGoogle, refreshUser, loading }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}