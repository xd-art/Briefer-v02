{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import RichTextDisplay from'./RichTextDisplay';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Card=_ref=>{let{card,onEdit,onMoveUp,onMoveDown,onDelete,isFirst,isLast}=_ref;const[showMenu,setShowMenu]=useState(false);const menuRef=useRef(null);// Close menu when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{if(menuRef.current&&!menuRef.current.contains(event.target)){setShowMenu(false);}};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[]);// Handle edit link clicks within the card\nconst handleClick=e=>{// Edit link handling - support legacy embedded links just in case, but prefer the button\nif(e.target.classList.contains('edit-link')){e.preventDefault();onEdit(card);return;}// AI link handling\nif(e.target.tagName.toLowerCase()==='ai-link'||e.target.classList.contains('ai-link')){e.preventDefault();const topic=e.target.getAttribute('topic');const template=e.target.getAttribute('template')||'';const url=\"/?action=generate&topic=\".concat(encodeURIComponent(topic),\"&template=\").concat(encodeURIComponent(template));window.open(url,'_blank');}};const handleEditClick=e=>{e.stopPropagation();onEdit(card);};// Helper to clean legacy content\nconst cleanContent=html=>{if(!html)return'';// Remove the specific edit link div structure we used to add\nreturn html.replace(/<div class=\"flex justify-end\">\\s*<a href=\"#\" class=\"edit-link\"[^>]*>EDIT<\\/a>\\s*<\\/div>/g,'');};return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 border-b border-gray-200 pb-6\",\"data-card-id\":card.id,onClick:handleClick,children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end mb-2 relative z-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",ref:menuRef,children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setShowMenu(!showMenu);},className:\"p-1 rounded-full hover:bg-gray-100 text-gray-500 transition-colors\",title:\"More options\",children:/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",children:\"more_vert\"})}),showMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"py-1\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();setShowMenu(false);onDelete&&onDelete();},className:\"flex items-center w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-700 transition-colors\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined text-sm mr-2\",children:\"delete\"}),\"Delete\"]})})})]})}),card.heading&&/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-4\",children:card.heading}),/*#__PURE__*/_jsx(RichTextDisplay,{content:cleanContent(card.content)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-4 pl-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onMoveUp();},disabled:isFirst,className:\"p-3 rounded-full transition-colors flex items-center justify-center \".concat(isFirst?'text-gray-300 cursor-not-allowed':'text-gray-500 hover:text-gray-800 hover:bg-gray-100'),title:\"Move Up\",\"aria-label\":\"Move Up\",children:/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",children:\"keyboard_arrow_up\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onMoveDown();},disabled:isLast,className:\"p-3 rounded-full transition-colors flex items-center justify-center \".concat(isLast?'text-gray-300 cursor-not-allowed':'text-gray-500 hover:text-gray-800 hover:bg-gray-100'),title:\"Move Down\",\"aria-label\":\"Move Down\",children:/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",children:\"keyboard_arrow_down\"})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEditClick,className:\"px-6 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 hover:text-blue-800 rounded transition-colors\",children:\"EDIT\"})]})]});};export default/*#__PURE__*/React.memo(Card);","map":{"version":3,"names":["React","useState","useRef","useEffect","RichTextDisplay","jsx","_jsx","jsxs","_jsxs","Card","_ref","card","onEdit","onMoveUp","onMoveDown","onDelete","isFirst","isLast","showMenu","setShowMenu","menuRef","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleClick","e","classList","preventDefault","tagName","toLowerCase","topic","getAttribute","template","url","concat","encodeURIComponent","window","open","handleEditClick","stopPropagation","cleanContent","html","replace","className","id","onClick","children","ref","title","heading","content","disabled","memo"],"sources":["D:/SRC/XAMPP/htdocs/sites/Briefer-v02/src/components/Card.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport RichTextDisplay from './RichTextDisplay';\r\n\r\nconst Card = ({ card, onEdit, onMoveUp, onMoveDown, onDelete, isFirst, isLast }) => {\r\n    const [showMenu, setShowMenu] = useState(false);\r\n    const menuRef = useRef(null);\r\n\r\n    // Close menu when clicking outside\r\n    useEffect(() => {\r\n        const handleClickOutside = (event) => {\r\n            if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n                setShowMenu(false);\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => {\r\n            document.removeEventListener('mousedown', handleClickOutside);\r\n        };\r\n    }, []);\r\n    // Handle edit link clicks within the card\r\n    const handleClick = (e) => {\r\n        // Edit link handling - support legacy embedded links just in case, but prefer the button\r\n        if (e.target.classList.contains('edit-link')) {\r\n            e.preventDefault();\r\n            onEdit(card);\r\n            return;\r\n        }\r\n        // AI link handling\r\n        if (e.target.tagName.toLowerCase() === 'ai-link' || e.target.classList.contains('ai-link')) {\r\n            e.preventDefault();\r\n            const topic = e.target.getAttribute('topic');\r\n            const template = e.target.getAttribute('template') || '';\r\n            const url = `/?action=generate&topic=${encodeURIComponent(topic)}&template=${encodeURIComponent(template)}`;\r\n            window.open(url, '_blank');\r\n        }\r\n    };\r\n\r\n    const handleEditClick = (e) => {\r\n        e.stopPropagation();\r\n        onEdit(card);\r\n    };\r\n\r\n    // Helper to clean legacy content\r\n    const cleanContent = (html) => {\r\n        if (!html) return '';\r\n        // Remove the specific edit link div structure we used to add\r\n        return html.replace(/<div class=\"flex justify-end\">\\s*<a href=\"#\" class=\"edit-link\"[^>]*>EDIT<\\/a>\\s*<\\/div>/g, '');\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"mb-8 border-b border-gray-200 pb-6\"\r\n            data-card-id={card.id}\r\n            onClick={handleClick}\r\n        >\r\n            {/* Kebab Menu - Always Top Right */}\r\n            <div className=\"flex justify-end mb-2 relative z-10\">\r\n                <div className=\"relative\" ref={menuRef}>\r\n                    <button\r\n                        onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setShowMenu(!showMenu);\r\n                        }}\r\n                        className=\"p-1 rounded-full hover:bg-gray-100 text-gray-500 transition-colors\"\r\n                        title=\"More options\"\r\n                    >\r\n                        <span className=\"material-symbols-outlined\">more_vert</span>\r\n                    </button>\r\n\r\n                    {showMenu && (\r\n                        <div className=\"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50\">\r\n                            <div className=\"py-1\">\r\n                                <button\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        setShowMenu(false);\r\n                                        onDelete && onDelete();\r\n                                    }}\r\n                                    className=\"flex items-center w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-700 transition-colors\"\r\n                                >\r\n                                    <span className=\"material-symbols-outlined text-sm mr-2\">delete</span>\r\n                                    Delete\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Heading (if exists separately) */}\r\n            {card.heading && (\r\n                <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">{card.heading}</h2>\r\n            )}\r\n\r\n            <RichTextDisplay content={cleanContent(card.content)} />\r\n\r\n            {/* Card Controls Footer */}\r\n            <div className=\"flex items-center justify-between mt-4 pl-1\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                    {/* Move Up Button - Material Icon */}\r\n                    <button\r\n                        onClick={(e) => { e.stopPropagation(); onMoveUp(); }}\r\n                        disabled={isFirst}\r\n                        className={`p-3 rounded-full transition-colors flex items-center justify-center ${isFirst\r\n                            ? 'text-gray-300 cursor-not-allowed'\r\n                            : 'text-gray-500 hover:text-gray-800 hover:bg-gray-100'\r\n                            }`}\r\n                        title=\"Move Up\"\r\n                        aria-label=\"Move Up\"\r\n                    >\r\n                        <span className=\"material-symbols-outlined\">keyboard_arrow_up</span>\r\n                    </button>\r\n\r\n                    {/* Move Down Button - Material Icon */}\r\n                    <button\r\n                        onClick={(e) => { e.stopPropagation(); onMoveDown(); }}\r\n                        disabled={isLast}\r\n                        className={`p-3 rounded-full transition-colors flex items-center justify-center ${isLast\r\n                            ? 'text-gray-300 cursor-not-allowed'\r\n                            : 'text-gray-500 hover:text-gray-800 hover:bg-gray-100'\r\n                            }`}\r\n                        title=\"Move Down\"\r\n                        aria-label=\"Move Down\"\r\n                    >\r\n                        <span className=\"material-symbols-outlined\">keyboard_arrow_down</span>\r\n                    </button>\r\n                </div>\r\n\r\n                <button\r\n                    onClick={handleEditClick}\r\n                    className=\"px-6 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 hover:text-blue-800 rounded transition-colors\"\r\n                >\r\n                    EDIT\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(Card);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}