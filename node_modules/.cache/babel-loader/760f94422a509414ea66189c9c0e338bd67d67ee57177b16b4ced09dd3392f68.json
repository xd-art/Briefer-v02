{"ast":null,"code":"import { optimizedLocalStorage } from './performance';\nconst STORAGE_KEY = 'articles_library';\nconst CURRENT_ARTICLE_ID_KEY = 'current_article_id';\n\n// Legacy keys for migration\nconst LEGACY_DATA_KEY = 'cardEditorData';\nconst LEGACY_TITLE_KEY = 'articleTitle';\nexport const ArticleManager = {\n  /**\r\n   * Get all articles from storage\r\n   * @returns {Object} Map of article objects keyed by ID\r\n   */\n  getAllArticles: () => {\n    return optimizedLocalStorage.getItem(STORAGE_KEY) || {};\n  },\n  /**\r\n   * Get a specific article by ID\r\n   * @param {string} id - The article ID\r\n   * @returns {Object|null} The article data or null if not found\r\n   */\n  getArticle: id => {\n    const articles = ArticleManager.getAllArticles();\n    return articles[id] || null;\n  },\n  /**\r\n   * Save an article\r\n   * @param {string} id - The article ID\r\n   * @param {Object} data - The article data (title, cards, etc.)\r\n   * @returns {boolean} Success status\r\n   */\n  saveArticle: (id, data) => {\n    const articles = ArticleManager.getAllArticles();\n    articles[id] = {\n      ...articles[id],\n      ...data,\n      lastModified: new Date().toISOString()\n    };\n    return optimizedLocalStorage.setItem(STORAGE_KEY, articles);\n  },\n  /**\r\n   * Create a new article\r\n   * @param {string} topic - The topic of the article\r\n   * @param {string} template - The template type (guide, faq, etc.)\r\n   * @returns {string} The new article ID\r\n   */\n  createArticle: (topic = 'Untitled', template = 'guide') => {\n    const id = 'article_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\n    const newArticle = {\n      id,\n      title: topic,\n      cards: [],\n      // Initial empty cards\n      template,\n      created: new Date().toISOString(),\n      lastModified: new Date().toISOString()\n    };\n    ArticleManager.saveArticle(id, newArticle);\n    return id;\n  },\n  /**\r\n   * Delete an article\r\n   * @param {string} id - The article ID\r\n   */\n  deleteArticle: id => {\n    const articles = ArticleManager.getAllArticles();\n    if (articles[id]) {\n      delete articles[id];\n      optimizedLocalStorage.setItem(STORAGE_KEY, articles);\n    }\n  },\n  /**\r\n   * Set the current active article ID\r\n   * @param {string} id - The article ID\r\n   */\n  setCurrentArticleId: id => {\n    optimizedLocalStorage.setItem(CURRENT_ARTICLE_ID_KEY, id);\n  },\n  /**\r\n   * Get the current active article ID\r\n   * @returns {string|null} The current article ID\r\n   */\n  getCurrentArticleId: () => {\n    return optimizedLocalStorage.getItem(CURRENT_ARTICLE_ID_KEY);\n  },\n  /**\r\n   * Migrate legacy single-article data to the new library format\r\n   * @returns {string|null} The ID of the migrated article, or null if no migration needed\r\n   */\n  migrateOldData: () => {\n    const articles = ArticleManager.getAllArticles();\n\n    // If library is not empty, assume migration already happened or isn't needed\n    if (Object.keys(articles).length > 0) {\n      return null;\n    }\n    const legacyData = optimizedLocalStorage.getItem(LEGACY_DATA_KEY);\n    const legacyTitle = optimizedLocalStorage.getItem(LEGACY_TITLE_KEY);\n    if (legacyData) {\n      // Create a new article from legacy data\n      const id = 'article_migrated_' + Date.now();\n\n      // Convert legacy object format to array format if needed, \n      // but App.js seems to handle the conversion. \n      // We will store it as is, and let App.js handle the structure for now, \n      // or better, standardize it here.\n      // App.js expects: cards array. \n      // Legacy storage was: { id: content } map.\n\n      let cardsArray = [];\n      if (legacyData && typeof legacyData === 'object') {\n        cardsArray = Object.entries(legacyData).map(([cardId, content]) => ({\n          id: cardId,\n          content\n        }));\n      }\n      const migratedArticle = {\n        id,\n        title: legacyTitle || 'Untitled Article (Restored)',\n        cards: cardsArray,\n        template: 'guide',\n        created: new Date().toISOString(),\n        lastModified: new Date().toISOString()\n      };\n      ArticleManager.saveArticle(id, migratedArticle);\n\n      // Optional: Clear legacy data to avoid confusion? \n      // Let's keep it for safety for now, or maybe clear it to force usage of new system.\n      // optimizedLocalStorage.removeItem(LEGACY_DATA_KEY);\n      // optimizedLocalStorage.removeItem(LEGACY_TITLE_KEY);\n\n      return id;\n    }\n    return null;\n  }\n};","map":{"version":3,"names":["optimizedLocalStorage","STORAGE_KEY","CURRENT_ARTICLE_ID_KEY","LEGACY_DATA_KEY","LEGACY_TITLE_KEY","ArticleManager","getAllArticles","getItem","getArticle","id","articles","saveArticle","data","lastModified","Date","toISOString","setItem","createArticle","topic","template","now","Math","random","toString","substr","newArticle","title","cards","created","deleteArticle","setCurrentArticleId","getCurrentArticleId","migrateOldData","Object","keys","length","legacyData","legacyTitle","cardsArray","entries","map","cardId","content","migratedArticle"],"sources":["D:/SRC/XAMPP/htdocs/sites/Briefer-v02/src/utils/ArticleManager.js"],"sourcesContent":["import { optimizedLocalStorage } from './performance';\r\n\r\nconst STORAGE_KEY = 'articles_library';\r\nconst CURRENT_ARTICLE_ID_KEY = 'current_article_id';\r\n\r\n// Legacy keys for migration\r\nconst LEGACY_DATA_KEY = 'cardEditorData';\r\nconst LEGACY_TITLE_KEY = 'articleTitle';\r\n\r\nexport const ArticleManager = {\r\n    /**\r\n     * Get all articles from storage\r\n     * @returns {Object} Map of article objects keyed by ID\r\n     */\r\n    getAllArticles: () => {\r\n        return optimizedLocalStorage.getItem(STORAGE_KEY) || {};\r\n    },\r\n\r\n    /**\r\n     * Get a specific article by ID\r\n     * @param {string} id - The article ID\r\n     * @returns {Object|null} The article data or null if not found\r\n     */\r\n    getArticle: (id) => {\r\n        const articles = ArticleManager.getAllArticles();\r\n        return articles[id] || null;\r\n    },\r\n\r\n    /**\r\n     * Save an article\r\n     * @param {string} id - The article ID\r\n     * @param {Object} data - The article data (title, cards, etc.)\r\n     * @returns {boolean} Success status\r\n     */\r\n    saveArticle: (id, data) => {\r\n        const articles = ArticleManager.getAllArticles();\r\n\r\n        articles[id] = {\r\n            ...articles[id],\r\n            ...data,\r\n            lastModified: new Date().toISOString()\r\n        };\r\n\r\n        return optimizedLocalStorage.setItem(STORAGE_KEY, articles);\r\n    },\r\n\r\n    /**\r\n     * Create a new article\r\n     * @param {string} topic - The topic of the article\r\n     * @param {string} template - The template type (guide, faq, etc.)\r\n     * @returns {string} The new article ID\r\n     */\r\n    createArticle: (topic = 'Untitled', template = 'guide') => {\r\n        const id = 'article_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\r\n        const newArticle = {\r\n            id,\r\n            title: topic,\r\n            cards: [], // Initial empty cards\r\n            template,\r\n            created: new Date().toISOString(),\r\n            lastModified: new Date().toISOString()\r\n        };\r\n\r\n        ArticleManager.saveArticle(id, newArticle);\r\n        return id;\r\n    },\r\n\r\n    /**\r\n     * Delete an article\r\n     * @param {string} id - The article ID\r\n     */\r\n    deleteArticle: (id) => {\r\n        const articles = ArticleManager.getAllArticles();\r\n        if (articles[id]) {\r\n            delete articles[id];\r\n            optimizedLocalStorage.setItem(STORAGE_KEY, articles);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the current active article ID\r\n     * @param {string} id - The article ID\r\n     */\r\n    setCurrentArticleId: (id) => {\r\n        optimizedLocalStorage.setItem(CURRENT_ARTICLE_ID_KEY, id);\r\n    },\r\n\r\n    /**\r\n     * Get the current active article ID\r\n     * @returns {string|null} The current article ID\r\n     */\r\n    getCurrentArticleId: () => {\r\n        return optimizedLocalStorage.getItem(CURRENT_ARTICLE_ID_KEY);\r\n    },\r\n\r\n    /**\r\n     * Migrate legacy single-article data to the new library format\r\n     * @returns {string|null} The ID of the migrated article, or null if no migration needed\r\n     */\r\n    migrateOldData: () => {\r\n        const articles = ArticleManager.getAllArticles();\r\n\r\n        // If library is not empty, assume migration already happened or isn't needed\r\n        if (Object.keys(articles).length > 0) {\r\n            return null;\r\n        }\r\n\r\n        const legacyData = optimizedLocalStorage.getItem(LEGACY_DATA_KEY);\r\n        const legacyTitle = optimizedLocalStorage.getItem(LEGACY_TITLE_KEY);\r\n\r\n        if (legacyData) {\r\n            // Create a new article from legacy data\r\n            const id = 'article_migrated_' + Date.now();\r\n\r\n            // Convert legacy object format to array format if needed, \r\n            // but App.js seems to handle the conversion. \r\n            // We will store it as is, and let App.js handle the structure for now, \r\n            // or better, standardize it here.\r\n            // App.js expects: cards array. \r\n            // Legacy storage was: { id: content } map.\r\n\r\n            let cardsArray = [];\r\n            if (legacyData && typeof legacyData === 'object') {\r\n                cardsArray = Object.entries(legacyData).map(([cardId, content]) => ({\r\n                    id: cardId,\r\n                    content\r\n                }));\r\n            }\r\n\r\n            const migratedArticle = {\r\n                id,\r\n                title: legacyTitle || 'Untitled Article (Restored)',\r\n                cards: cardsArray,\r\n                template: 'guide',\r\n                created: new Date().toISOString(),\r\n                lastModified: new Date().toISOString()\r\n            };\r\n\r\n            ArticleManager.saveArticle(id, migratedArticle);\r\n\r\n            // Optional: Clear legacy data to avoid confusion? \r\n            // Let's keep it for safety for now, or maybe clear it to force usage of new system.\r\n            // optimizedLocalStorage.removeItem(LEGACY_DATA_KEY);\r\n            // optimizedLocalStorage.removeItem(LEGACY_TITLE_KEY);\r\n\r\n            return id;\r\n        }\r\n\r\n        return null;\r\n    }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}